结合你的技术栈（SpringBoot+MySQL+Vue3+Redis）和“碎片时间管理+AI推荐+邮件推送”的核心需求，我们可以设计一个名为「碎时拾光」的前后端分离项目。以下是详细的技术实现方案：


### **一、核心功能模块与业务流程**  
先明确项目的核心模块，确保技术实现围绕业务闭环设计：  

| 模块               | 核心功能                                                                 |  
|--------------------|--------------------------------------------------------------------------|  
| 1. 用户中心         | 注册/登录、个人信息管理（职业、技能标签、提升目标）、账号设置（邮件订阅开关） |  
| 2. 任务管理         | 日常任务录入（固定时间任务，如“9:00-10:00开会”）、碎片任务记录（如“30分钟阅读”） |  
| 3. 日程分析         | 自动识别空闲时段（从日程表中排除固定任务后的空白时间，如“14:00-14:20空闲”） |  
| 4. AI推荐引擎       | 根据空闲时长、用户职业/目标，推荐匹配的提升活动（如“15分钟学Python语法”）   |  
| 5. 报告与推送       | 生成日报（当日任务+碎片时间利用）、周报（周统计+下周建议），通过邮件自动推送 |  


### **二、技术架构设计**  
#### **1. 整体架构**  
采用前后端分离架构，后端提供API，前端负责交互，通过Redis缓存高频数据，MySQL存储核心业务数据：  
```  
前端（Vue3） <--> 后端API（SpringBoot） <--> 数据层（MySQL+Redis）  
                          |  
                          v  
                    外部服务（邮件服务、AI接口）  
```  


#### **2. 后端技术实现（SpringBoot）**  
##### **（1）核心依赖**  
- 基础框架：`spring-boot-starter-web`（RESTful API）、`spring-boot-starter-security`（认证授权）  
- 数据层：`spring-boot-starter-data-jpa`/`mybatis-plus`（MySQL操作）、`spring-boot-starter-data-redis`（缓存）  
- 工具类：`jjwt`（JWT令牌）、`spring-boot-starter-mail`（邮件发送）、`hutool`（时间计算/数据处理）  


##### **（2）数据库设计（MySQL）**  
需设计5张核心表，覆盖用户、任务、日程、推荐、报告全流程：  

| 表名               | 核心字段                                                                 | 作用                                   |  
|--------------------|--------------------------------------------------------------------------|----------------------------------------|  
| `user`             | id, username, email, password（加密）, career, skill_tags, goal         | 存储用户基本信息、职业和提升目标       |  
| `fixed_task`       | id, user_id, title, start_time, end_time, status（完成/未完成）          | 固定时间任务（如会议、工作项）         |  
| `fragment_task`    | id, user_id, title, duration（时长分钟）, start_time, status             | 碎片时间任务（如“学单词”，记录实际发生时间） |  
| `recommend_activity` | id, type（职业/通用）, title, duration, content（操作步骤）              | 预设的推荐活动库（如“Python基础题练习”） |  
| `report`           | id, user_id, type（日报/周报）, generate_time, content（JSON格式）       | 存储生成的报告内容，便于历史查看       |  


##### **（3）核心业务逻辑实现**  
- **用户认证与信息管理**：  
  - 用JWT实现登录认证，密码通过BCrypt加密存储；  
  - 个人信息接口（`/api/user/profile`）支持CRUD，技能标签用逗号分隔存储（如“Python,写作,健身”）。  

- **任务管理与日程分析**：  
  - 固定任务接口（`/api/task/fixed`）：添加时校验时间不重叠（通过`start_time`和`end_time`查询冲突）；  
  - 碎片任务接口（`/api/task/fragment`）：记录用户实际完成的碎片活动（关联推荐活动ID或自定义）；  
  - 空闲时间计算：每日凌晨通过定时任务（`@Scheduled`）分析当日固定任务，计算空白时段（如`[10:00-10:15, 15:30-16:00]`），结果存入Redis（`key: user:{userId}:freeTime:{date}`），有效期24小时。  

- **AI推荐引擎（初期轻量化实现）**：  
  - 不依赖复杂AI模型，先用**规则引擎**实现推荐逻辑（降低开发难度，确保可用）：  
    1. 从`recommend_activity`表加载预设活动（按职业分类，如“程序员”对应“算法题、技术文档阅读”）；  
    2. 结合用户空闲时长（如10分钟→推荐“短视频课程”，30分钟→推荐“小练习”）和技能目标（如用户标签含“Python”，优先推荐Python相关）；  
    3. 推荐结果接口（`/api/recommend`）返回TOP3活动，同时缓存到Redis（`key: user:{userId}:recommend`，1小时过期）。  
  - 后期可扩展：接入GPT-3.5-turbo API（通过`openai-java`客户端），传入用户信息+空闲时间，生成更个性化推荐。  

- **日报/周报生成与邮件推送**：  
  - 定时任务：  
    - 日报：每日20:00触发（`@Scheduled(cron = "0 0 20 * * ?")`），汇总当日`fixed_task`（完成情况）和`fragment_task`（总时长、活动类型），生成JSON格式内容存入`report`表；  
    - 周报：每周日20:00触发，汇总本周数据，计算“碎片时间利用率”（完成碎片任务时长/总空闲时长），附加下周推荐建议；  
  - 邮件推送：  
    - 配置SMTP服务（如QQ邮箱：`host=smtp.qq.com, port=587`，需用户提供授权码）；  
    - 生成报告后，通过`JavaMailSender`发送，邮件模板用Thymeleaf渲染（含表格展示任务、图表展示时间分布）；  
    - 支持用户在`user`表中设置`email_subscribe`开关（0/1），仅推送开启的用户。  


##### **（4）Redis缓存设计**  
- 缓存高频访问数据，减少MySQL压力：  
  - `user:{userId}:profile`：用户个人信息（1小时过期，更新后主动刷新）；  
  - `user:{userId}:freeTime:{date}`：当日空闲时段（24小时过期）；  
  - `user:{userId}:recommend`：AI推荐活动（1小时过期）；  
  - `hot_activities`：热门推荐活动（全用户共享，2小时过期）。  


#### **3. 前端技术实现（Vue3）**  
##### **（1）核心依赖与架构**  
- 构建工具：Vite（快于Webpack）；  
- 路由：Vue Router（管理页面跳转）；  
- 状态管理：Pinia（存储用户信息、当前任务列表）；  
- UI组件：Element Plus（表单、日历、图表等组件）；  
- 图表：ECharts（展示周报中的时间利用趋势）。  


##### **（2）核心页面与组件**  
1. **登录/注册页**：  
   - 表单验证（邮箱格式、密码强度），登录后存储JWT到`localStorage`，请求头携带令牌。  

2. **个人信息页**：  
   - 表单编辑职业（下拉选择，如“学生、程序员、设计师”）、技能标签（输入框+自动补全）、提升目标（文本框），保存后调用`/api/user/profile`更新。  

3. **日程表页**：  
   - 用Element Plus的`Calendar`组件展示日期，点击日期可查看/添加当日任务；  
   - 时间轴组件展示固定任务（如“9:00-10:00 开会”），自动标记空闲时段（灰色背景），点击空闲时段可直接添加碎片任务。  

4. **推荐活动页**：  
   - 展示AI推荐的碎片活动（含标题、时长、操作步骤），点击“立即做”可记录为`fragment_task`（自动填充当前时间）。  

5. **报告中心页**：  
   - 列表展示历史日报/周报，点击可查看详情（用ECharts展示碎片时间占比）；  
   - 支持手动触发“生成今日报告”（测试用）。  


##### **（3）交互优化**  
- 空闲时间实时计算：添加/删除固定任务后，前端立即重新计算并刷新空闲时段展示；  
- 推荐活动筛选：可按“时长”（10分钟内/10-30分钟）筛选；  
- 邮件订阅开关：个人信息页添加切换按钮，实时同步到`user`表的`email_subscribe`字段。  


### **三、数据流程示例**  
1. 用户注册→完善个人信息（职业：程序员，技能标签：Python，目标：提升算法）；  
2. 添加固定任务：“14:00-16:00 开发接口”；  
3. 系统凌晨计算当日空闲时间：`[10:00-10:30, 16:30-17:00]`，存入Redis；  
4. 用户打开推荐页，后端从Redis取空闲时间，结合职业和标签，推荐“10:00-10:30 刷2道LeetCode简单题”；  
5. 用户10:30完成后，标记碎片任务为“已完成”；  
6. 当日20:00，系统生成日报：“固定任务完成1项，碎片时间利用30分钟（LeetCode刷题）”，通过邮件推送给用户；  
7. 周日生成周报：“本周碎片时间总利用3小时，主要活动：刷题（1.5h）、阅读（1.5h），下周推荐：尝试Python小项目（30分钟/次）”。  


### **四、技术难点与解决方案**  
1. **空闲时间计算准确性**：  
   - 问题：固定任务时间重叠、跨天任务（如“23:00-01:00”）需特殊处理；  
   - 方案：用Java的`LocalDateTime`处理时间，排序固定任务后遍历计算空白区间，排除非活跃时段（如凌晨2-6点，可配置）。  

2. **邮件发送稳定性**：  
   - 问题：SMTP服务超时、邮件被拦截；  
   - 方案：发送失败后重试3次（用`@Retryable`注解），记录发送日志到`report`表（`email_status`字段），支持用户在报告中心手动重新发送。  

3. **AI推荐相关性**：  
   - 问题：初期规则引擎推荐可能不够精准；  
   - 方案：记录用户对推荐活动的“完成率”（点击“立即做”并标记完成），用Redis存储用户偏好（`user:{userId}:preference`），动态调整推荐权重（如完成率高的活动类型优先推荐）。  


### **五、部署与扩展建议**  
- 开发环境：用Docker Compose部署MySQL、Redis，前后端分别启动（前端`npm run dev`，后端`mvn spring-boot:run`）；  
- 生产环境：后端打包成Jar部署到云服务器，前端打包成静态文件用Nginx托管，MySQL和Redis用云数据库（如阿里云RDS）；  
- 扩展方向：后期接入微信公众号推送（替代部分邮件功能）、添加“好友PK”（碎片时间利用排名）增加粘性。  


这个方案基于你的技术栈，聚焦“碎片时间+AI推荐+报告推送”核心需求，逻辑闭环清晰，且初期实现难度可控（AI用规则引擎简化），适合作为比赛项目开发。核心亮点是“从用户日程中主动挖掘价值”，比传统日程表更懂用户的提升需求~